function P = Bartlett_P(Y, M)
    P = zeros(size(Y));
    m = mod(size(Y,2),M);
    
    for i = 0:M:size(Y,2)
       
        if(i>=(size(Y,2)-M))
            P(:,i+1:i+m) = repmat(sum(abs(Y(:,i+1:i+m)).^2, 2)/m, 1, m);
        end
        i
    end
    
end